package com.tms.servlets;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;

import java.io.IOException;

import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletContext;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import com.tms.constant.UserRole;
import com.tms.utils.TrainUtil;

import java.io.IOException;

@SuppressWarnings("serial")
@WebServlet("/payment")
public class BookTrainPayment extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse res)
            throws IOException, ServletException {
        res.setContentType("text/html");
        TrainUtil.validateUserAuthorization(req, UserRole.CUSTOMER);

        // read form parameters
        int seats = Integer.parseInt(req.getParameter("seats"));
        String trainNo = req.getParameter("trainnumber");
        String journeyDate = req.getParameter("journeydate");
        String travelClass = req.getParameter("class");

        // stash in request so JSP can pick them up
        req.setAttribute("seats", seats);
        req.setAttribute("trainnumber", trainNo);
        req.setAttribute("journeydate", journeyDate);
        req.setAttribute("class", travelClass);

        // forward to a JSP (not static HTML) which will render hidden fields
        req.getRequestDispatcher("Payment.html")
           .forward(req, res);
    }
}


//@WebServlet("/payment")
//public class BookTrainPayment extends HttpServlet {
//	/**
//	 * 
//	 */
//	private static final long serialVersionUID = 1L;
//
//	public void doPost(HttpServletRequest req, HttpServletResponse res) throws IOException, ServletException {
//		res.setContentType("text/html");
//		TrainUtil.validateUserAuthorization(req, UserRole.CUSTOMER);
//
//		int seat = Integer.parseInt(req.getParameter("seats"));
//		String trainNo = req.getParameter("trainnumber");
//		String journeyDate = req.getParameter("journeydate");
//		String seatClass = req.getParameter("class");
//		ServletContext sct = req.getServletContext();
//		sct.setAttribute("seats", seat);
//		sct.setAttribute("trainnumber", trainNo);
//		sct.setAttribute("journeydate", journeyDate);
//		sct.setAttribute("class", seatClass);
//		RequestDispatcher rd = req.getRequestDispatcher("Payment.html");
//		rd.forward(req, res);
//
//	}
//}